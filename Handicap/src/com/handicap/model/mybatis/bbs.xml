<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="bbs">


   <!-- 공지사항 글 작성 -->
   <insert id="bbsNoticeWrite" parameterType="com.handicap.model.beans.BbsVO">
      insert into bbsnotice(title, writedate, author, contents)
      values(#{title}, sysdate, #{author}, #{contents})      
   </insert>
   
   <!-- 파일올리는 쿼리 -->
   <insert id="bbsfile" parameterType="com.handicap.model.beans.FileVO">      
      insert into bbsfile(filename)
      values(#{filename, jdbcType=VARCHAR})
   </insert>
   
   <!-- 파일id 구하는 쿼리 -->
   <select id="fileid" resultType="int">
      select max(fileid) from bbsfile      
   </select>
   
   <!-- 공지사항의 글번호 구하는 쿼리 -->
   <select id="noticeno" resultType="int">
      select max(no) from bbsnotice
   </select>
   
   <!--  파일업로드에 등록하는 쿼리 -->
   <insert id="fileupload" parameterType="Map">
      insert into fileupload(no, boardno, fileid)
      values(#{no}, #{boardno}, #{fileid})
   </insert>   
   
   <!-- 파일 보기 -->
    <select id="bbsfilename" parameterType="Map" resultType="com.handicap.model.beans.FileVO">
      select filename, fileupload.fileid 
      from fileupload inner join bbsfile on fileupload.fileid = bbsfile.fileid 
      where no = #{no} and boardno = #{boardno}
   </select>
   
   <!-- 공지 삭제 -->
   <delete id="bbsNoticeDelete" parameterType="int">
      delete bbsnotice where no = #{no}
   </delete>   
   
   <!-- fileupload 삭제 -->
   <delete id="fileuploadDelete" parameterType="int">
      delete fileupload where fileid = #{fileid}
   </delete>   

   <!-- 공지사항 리스트 -->
   <select id="bbsNoticeList" parameterType="string"
      resultType="com.handicap.model.beans.BbsVO">      
      select * from bbsnotice order by writedate desc
   </select>
   
   <!-- 공지사항 글보기 -->
   <select id="bbsNoticeContent" parameterType="int"
      resultType="com.handicap.model.beans.BbsVO">
      select * from bbsnotice where no = #{no}
   </select>   
   
   <!-- 공지사항 수정 -->
   <update id="bbsNoticeUpdate" parameterType="com.handicap.model.beans.BbsVO">
      update bbsnotice set title = #{title}, contents = #{contents} 
      where no=#{no}
   </update>
      
   <!-- 공지사항 조회수 증가 -->
   <update id="bbsNoticeHitPlus" parameterType="int">
      update bbsnotice set hits = hits+1 where no = #{no}
   </update>
   
   <!-- 공지사항 추천수 증가 -> 테이블에 good이 없는 관계로 보류 -->
   <update id="goodupdate" parameterType="int">
      update bbsnotice set good = good+1 where no = #{no}
   </update>
   
   <!-- 댓글 작성 -->
   <insert id="bbscomment" parameterType="com.handicap.model.beans.BbsCommentVO">
      insert into bbscomment(commentno, contents, author, bad)
      values(#{commentno}, contents, #{author}, #{bad})      
   </insert>
   
   <!-- 댓글찾기 -->
   <select id="findcomment" parameterType="string" resultType="com.handicap.model.beans.BbsCommentVO">
      select * from zipcode where dong like #{dong}
   </select>
   


</mapper>